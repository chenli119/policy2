# CORS ä»£ç†æœåŠ¡ä½¿ç”¨æŒ‡å—

## é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªåŸºäº NestJS çš„ CORS ä»£ç†æœåŠ¡ï¼Œä¸“é—¨ç”¨äºè§£å†³å‰ç«¯è·¨åŸŸé—®é¢˜ã€‚é€šè¿‡ç®€å•çš„ URL å‚æ•°ï¼Œæ‚¨å¯ä»¥è½»æ¾è®¿é—®ä»»ä½•ç¬¬ä¸‰æ–¹ APIï¼Œæ— éœ€æ‹…å¿ƒ CORS é™åˆ¶ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åŸºæœ¬ä½¿ç”¨æ–¹æ³•

```
https://your-domain.vercel.app/api/proxy?url=ç›®æ ‡URL
```

### å®é™…ç¤ºä¾‹

#### åŸæœ¬è·¨åŸŸçš„è¯·æ±‚ï¼ˆä¼šå¤±è´¥ï¼‰
```javascript
// âŒ è¿™ä¼šå¯¼è‡´ CORS é”™è¯¯
fetch('https://api.github.com/users/octocat')
  .then(response => response.json())
  .then(data => console.log(data))
  .catch(error => console.error('CORS Error:', error));
```

#### ä½¿ç”¨ä»£ç†æœåŠ¡ï¼ˆæˆåŠŸï¼‰
```javascript
// âœ… é€šè¿‡ä»£ç†æœåŠ¡è®¿é—®ï¼Œè§£å†³è·¨åŸŸé—®é¢˜
fetch('http://localhost:3000/api/proxy?url=https://api.github.com/users/octocat')
  .then(response => response.json())
  .then(data => console.log(data))
  .catch(error => console.error('Error:', error));
```

## ğŸ“‹ æ”¯æŒçš„ HTTP æ–¹æ³•

### GET è¯·æ±‚
```javascript
// è·å–ç”¨æˆ·ä¿¡æ¯
fetch('http://localhost:3000/api/proxy?url=https://jsonplaceholder.typicode.com/users/1')
```

### POST è¯·æ±‚
```javascript
// åˆ›å»ºæ–°æ•°æ®
fetch('http://localhost:3000/api/proxy?url=https://jsonplaceholder.typicode.com/posts', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    title: 'foo',
    body: 'bar',
    userId: 1
  })
})
```

### PUT è¯·æ±‚
```javascript
// æ›´æ–°æ•°æ®
fetch('http://localhost:3000/api/proxy?url=https://jsonplaceholder.typicode.com/posts/1', {
  method: 'PUT',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    id: 1,
    title: 'updated title',
    body: 'updated body',
    userId: 1
  })
})
```

### DELETE è¯·æ±‚
```javascript
// åˆ é™¤æ•°æ®
fetch('http://localhost:3000/api/proxy?url=https://jsonplaceholder.typicode.com/posts/1', {
  method: 'DELETE'
})
```

## ğŸ”§ æœ¬åœ°å¼€å‘

### 1. å®‰è£…ä¾èµ–
```bash
npm install
```

### 2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
npm run start:dev
```

### 3. æµ‹è¯•ä»£ç†æœåŠ¡
è®¿é—®: `http://localhost:3000/api/proxy?url=https://api.github.com/users/octocat`

## ğŸš€ éƒ¨ç½²åˆ° Vercel

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ Vercel CLI

1. **å®‰è£… Vercel CLI**
```bash
npm i -g vercel
```

2. **æ„å»ºé¡¹ç›®**
```bash
npm run build
```

3. **éƒ¨ç½²**
```bash
vercel
```

4. **æŒ‰ç…§æç¤ºå®Œæˆéƒ¨ç½²**
   - é€‰æ‹©é¡¹ç›®åç§°
   - ç¡®è®¤è®¾ç½®
   - ç­‰å¾…éƒ¨ç½²å®Œæˆ

### æ–¹æ³•äºŒï¼šGitHub é›†æˆéƒ¨ç½²

1. **æ¨é€ä»£ç åˆ° GitHub**
```bash
git add .
git commit -m "Initial commit"
git push origin main
```

2. **åœ¨ Vercel ä¸­å¯¼å…¥é¡¹ç›®**
   - è®¿é—® [Vercel Dashboard](https://vercel.com/dashboard)
   - ç‚¹å‡» "New Project"
   - é€‰æ‹©ä½ çš„ GitHub ä»“åº“
   - ç‚¹å‡» "Deploy"

3. **é…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¦‚éœ€è¦ï¼‰**
   - åœ¨ Vercel é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ç¯å¢ƒå˜é‡
   - é‡æ–°éƒ¨ç½²é¡¹ç›®

## ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§

### URL éªŒè¯
- åªå…è®¸ `http://` å’Œ `https://` åè®®
- éªŒè¯ URL æ ¼å¼çš„æœ‰æ•ˆæ€§
- é˜²æ­¢æ¶æ„ URL æ³¨å…¥

### è¯·æ±‚å¤´è¿‡æ»¤
- åªè½¬å‘å®‰å…¨çš„è¯·æ±‚å¤´
- è‡ªåŠ¨æ·»åŠ  User-Agent
- ç§»é™¤æ•æ„Ÿçš„å†…éƒ¨å¤´éƒ¨

### é”™è¯¯å¤„ç†
- å®Œå–„çš„é”™è¯¯ä¿¡æ¯è¿”å›
- è¶…æ—¶ä¿æŠ¤ï¼ˆ30ç§’ï¼‰
- é‡å®šå‘é™åˆ¶ï¼ˆæœ€å¤š5æ¬¡ï¼‰

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. "ç¼ºå°‘urlå‚æ•°" é”™è¯¯
**åŸå› **: æ²¡æœ‰æä¾› `url` æŸ¥è¯¢å‚æ•°
**è§£å†³**: ç¡®ä¿ URL æ ¼å¼ä¸º `?url=ç›®æ ‡URL`

#### 2. "URLæ ¼å¼æ— æ•ˆ" é”™è¯¯
**åŸå› **: æä¾›çš„ URL æ ¼å¼ä¸æ­£ç¡®
**è§£å†³**: ç¡®ä¿ URL åŒ…å«åè®®ï¼ˆhttp:// æˆ– https://ï¼‰

#### 3. è¯·æ±‚è¶…æ—¶
**åŸå› **: ç›®æ ‡æœåŠ¡å™¨å“åº”æ—¶é—´è¿‡é•¿
**è§£å†³**: æ£€æŸ¥ç›®æ ‡ URL æ˜¯å¦å¯è®¿é—®ï¼Œæˆ–ç¨åé‡è¯•

### è°ƒè¯•æŠ€å·§

1. **æ£€æŸ¥æ§åˆ¶å°æ—¥å¿—**
```bash
npm run start:dev
# æŸ¥çœ‹è¯¦ç»†çš„è¯·æ±‚æ—¥å¿—
```

2. **æµ‹è¯•ç®€å•çš„ API**
```javascript
// ä½¿ç”¨å…¬å¼€çš„æµ‹è¯• API
fetch('http://localhost:3000/api/proxy?url=https://httpbin.org/get')
```

3. **æ£€æŸ¥ç½‘ç»œè¯·æ±‚**
   - æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·
   - æŸ¥çœ‹ Network æ ‡ç­¾é¡µ
   - æ£€æŸ¥è¯·æ±‚å’Œå“åº”è¯¦æƒ…

## ğŸ“ API æ–‡æ¡£

### ç«¯ç‚¹
```
GET    /api/proxy?url={targetUrl}
POST   /api/proxy?url={targetUrl}
PUT    /api/proxy?url={targetUrl}
DELETE /api/proxy?url={targetUrl}
PATCH  /api/proxy?url={targetUrl}
OPTIONS /api/proxy
```

### å‚æ•°
- `url` (å¿…éœ€): ç›®æ ‡ API çš„å®Œæ•´ URL

### å“åº”
- æˆåŠŸ: è¿”å›ç›®æ ‡ API çš„åŸå§‹å“åº”
- å¤±è´¥: è¿”å›é”™è¯¯ä¿¡æ¯å’ŒçŠ¶æ€ç 

### ç¤ºä¾‹å“åº”
```json
{
  "error": "ç¼ºå°‘urlå‚æ•°",
  "usage": "è¯·ä½¿ç”¨ ?url=ç›®æ ‡URL çš„æ ¼å¼"
}
```

## ğŸ¯ ä½¿ç”¨åœºæ™¯

1. **å‰ç«¯å¼€å‘**: åœ¨å¼€å‘ç¯å¢ƒä¸­è®¿é—®ç¬¬ä¸‰æ–¹ API
2. **åŸå‹åˆ¶ä½œ**: å¿«é€Ÿé›†æˆå¤–éƒ¨æ•°æ®æº
3. **API æµ‹è¯•**: æµ‹è¯•ä¸åŒçš„ API ç«¯ç‚¹
4. **æ•°æ®èšåˆ**: ä»å¤šä¸ªæºæ”¶é›†æ•°æ®

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœæ‚¨é‡åˆ°é—®é¢˜æˆ–éœ€è¦å¸®åŠ©ï¼Œè¯·ï¼š
1. æ£€æŸ¥æœ¬æ–‡æ¡£çš„æ•…éšœæ’é™¤éƒ¨åˆ†
2. æŸ¥çœ‹é¡¹ç›®çš„ GitHub Issues
3. æäº¤æ–°çš„ Issue æè¿°æ‚¨çš„é—®é¢˜

---

**æ³¨æ„**: è¯·ç¡®ä¿éµå®ˆç›®æ ‡ API çš„ä½¿ç”¨æ¡æ¬¾å’Œé€Ÿç‡é™åˆ¶ã€‚è¿™ä¸ªä»£ç†æœåŠ¡ä»…ç”¨äºè§£å†³ CORS é—®é¢˜ï¼Œä¸åº”ç”¨äºç»•è¿‡ API çš„å®‰å…¨é™åˆ¶ã€‚